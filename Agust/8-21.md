# TIL Template

## ë‚ ì§œ: 2024-07-17

## Daily Scrum
- ì—¬í–‰ë°© API
- erd, api ëª…ì„¸ì„œ ìˆ˜ì •

## Today I Learned
1. `Controller` 
```java
package com.example.travelday.domain.travelroom.controller;

@Slf4j
@RestController
@RequestMapping("/api/rooms")
@RequiredArgsConstructor
public class TravelRoomController {

    private final TravelRoomService travelRoomService;

    /**
     * ì—¬í–‰ë°© ëª©ë¡ ì¡°íšŒ
     */
    @GetMapping
    public ResponseEntity<ApiResponseEntity<List<TravelRoomResDto>>> getAllTravelRoom() {
        List<TravelRoomResDto> travelRooms = travelRoomService.getAllTravelRoom();
        return ResponseEntity.ok(ApiResponseEntity.of(travelRooms));
    }
```

```java
package com.example.travelday.domain.travelroom.service;

@Slf4j
@Service
@RequiredArgsConstructor
public class TravelRoomService {

    private final TravelRoomRepository travelRoomRepository;

    private final UserTravelRoomRepository userTravelRoomRepository;

    private final MemberRepository memberRepository;

    /**
     * ì—¬í–‰ ë°© ëª©ë¡ ì¡°íšŒ
     */
    @Transactional(readOnly = true)
    public List<TravelRoomResDto> getAllTravelRoom() {
        return travelRoomRepository.findAll()
                    .stream()
                    .map(TravelRoomResDto::fromEntity)
                    .collect(Collectors.toList());
    }
```

```java

public interface TravelRoomRepository extends JpaRepository<TravelRoom, Long> {
}
```

1. @RequsetMapping ì„ í†µí•´ í•´ë‹¹ ì—”ë“œí¬ì¸íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì§„ì…
2. ê° Method ì™€ endpointì— ë§ëŠ” apië¡œ ì§„ì…
3. ResponseEntity<ApiResponseEntity<Strinig>> 
    - ResponseEntity ëŠ” HTTP ì‘ë‹µì˜ ìƒíƒœ ì½”ë“œ, í—¤ë”, ë°”ë””ë¥¼ í¬í•¨í•˜ëŠ” ì „ì²´ ì‘ë‹µì„ ë‚˜íƒ€ë‚´ì„œ ì œë„¤ë¦­ìœ¼ë¡œ ê°ì‹¸ì¤€ë‹¤.
    - ApiResponseEntity<String>ëŠ” APIì‘ë‹µ ë³¸ë¬¸(body)ì— í¬í•¨ë  ë°ì´í„° í˜•ì‹ì„ ì •ì˜í•˜ë©° ë©”ì„¸ì§€ë¥¼ ë°˜í™˜.
4. ìš”ì²­
    - @RequsetParam
        - http://localhost:8000/board?page=1&listSize=10
    - @PathVariable
        - http://localhost:8000/board/1
    - @RequestBody
        - http://localhost:8080/receive
    
    **@RequestParam**Â **query**Â ì²˜ë¦¬
    
    **@PathVariable**Â **URI ë³€ìˆ˜**Â ì²˜ë¦¬
    
    **@RequestBody**Â **JSON**Â ì²˜ë¦¬
    
5. ex) ì—¬í–‰ë°© ëª©ë¡ì¡°íšŒ
    - List<TravelRoomResDto> travelRooms: TravelRoomResDtoí˜•ì‹ì„ Listë¡œ travelRoomsì— ì €ì¥.
    - `travelRoomService.getAllTravelRoom()` ì´ìš©.
    - returnì€ ResponseEntity.okë¥¼ í†µí•´ ApiResponseEntity.of(travelRooms)) ì—ì„œ travelRoomsë¥¼ ë°˜í™˜
6. @Transaction(readOnly = true)
    - í•´ë‹¹ ë©”ì„œë“œê°€ íŠ¸ëœì­ì…˜ ë²”ìœ„ ë‚´ì—ì„œ ì‹¤í–‰ë˜ë„ë¡ ë³´ì¥
    - ì½ê¸° ì „ìš© íŠ¸ëœì­ì…˜( ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ ì‘ì—…ì´ ë°œìƒí•˜ì§€ ì•Šê³ , ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ë³€ê²½ëœ ë°ì´í„°ë¥¼ ì¶”ì í•˜ì§€ ì•Šì•„ì„œ ì„±ëŠ¥ í–¥ìƒ)
    
    **public List<TravelRoomResDto> getAllTravelRoom()**
    
    - ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ TravelRoomResDto í˜•ì‹ìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” í¼ë¸”ë¦­ ë©”ì„œë“œ. ë©”ì„œë“œ ì´ë¦„ì€ `getAllTravelRoom`.
    
    **return travelRoomRepository.findAll():**
    
    - travelRoomRepositoryë¥¼ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ëª¨ë“  TravelRoom ì—”í‹°í‹°ë¥¼ ì¡°íšŒ.
    - `findAll()`ë©”ì„œë“œëŠ” travelRoomRepository ì¸í„°í˜ì´ìŠ¤ì˜ ê¸°ë³¸ ë©”ì„œë“œë¡œ í•´ë‹¹ ì—”í‹°í‹°ì˜ ëª¨ë“  ë ˆì½”ë“œë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë°˜í™˜
    - travelRoomRespositoryëŠ” JpaRepositoryë¥¼ ìƒì†ë°›ì•„ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê¸°ë³¸ì ì¸ CRUD ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ”ë° í•„ìš”í•œ ë©”ì„œë“œ ì œê³µ.
    
    **.stream():**
    
    - `findAll()`ì´ ë°˜í™˜í•œ ë¦¬ìŠ¤íŠ¸ë¥¼ Java Stream APIë¡œ ë³€í™˜.
    - Streamì„ ì‚¬ìš©í•˜ë©´ ë¦¬ìŠ¤íŠ¸ ìš”ì†Œë¥¼ í•˜ë‚˜ì”© ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
    - ë¦¬ìŠ¤íŠ¸ì˜ ê° ìš”ì†Œì— ëŒ€í•´ ì¼ê´„ì ìœ¼ë¡œ ë³€í™˜ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
    - ì—¬ê¸°ì„œ TravelRoom ì—”í‹°í‹°ë¥¼ TravelRoomResDtoë¡œ ë³€í™˜í•˜ëŠ” ì‘ì—…ì´ ìˆ˜í–‰ëœë‹¤.
    - Streamì„ í†µí•´ ê°„ê²°í•˜ê³  íš¨ìœ¨ì ì¸ ë°ì´í„° ë³€í™˜ ì‘ì—…ì´ ì´ë£¨ì–´ì§
    
    **.map(TravelRoomResDto::fromEntity):**
    
    - map ë©”ì„œë“œë¥¼ í†µí•´ Streamì˜ ê° ìš”ì†Œë¥¼ ë³€í™˜í•˜ëŠ” ì—­í• ì„ í•œë‹¤.
    - ì—¬ê¸°ì„œ TravelRoom ì—”í‹°í‹°ë¥¼ TravelRoomResDtoë¡œ ë³€í™˜í•˜ëŠ” fromEntity ë©”ì„œë“œë¥¼ í˜¸ì¶œ
    - TravelRoomResDto::fromEntityëŠ” ë©”ì„œë“œ ì°¸ì¡° ë°©ì‹
    - ì´ ê³¼ì •ì—ì„œ ì—”í‹°í‹°ë¥¼ Dtoë¡œ ë³€í™˜í•˜ê³ , ë°ì´í„°ë² ì´ìŠ¤ì™€ ì§ì ‘ì ìœ¼ë¡œ ì—°ê´€ëœ ì—”í‹°í‹° ëŒ€ì‹  í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë°˜í™˜í•  ë°ì´í„°ë¥¼ ì¤€ë¹„
    
    **collect(Collectors.toList());:**
    
    - collect ë©”ì„œë“œëŠ” Streamì˜ ìš”ì†Œë“¤ì„ ìµœì¢…ì ìœ¼ë¡œ ìˆ˜ì§‘í•˜ì—¬, ì›í•˜ëŠ” ìë£Œêµ¬ì¡°(ì—¬ê¸°ì„œëŠ” ë¦¬ìŠ¤íŠ¸)ë¡œ ë³€í™˜.
    - Collectors.toList()ëŠ” Streamì˜ ìš”ì†Œë“¤ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ìˆ˜ì§‘í•©ë‹ˆë‹¤.
    - Streamì€ ê¸°ë³¸ì ìœ¼ë¡œ ì§€ì—° ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì—, collectì™€ ê°™ì€ ì¢…ë‹¨ ì—°ì‚°ì„ í˜¸ì¶œí•´ì•¼ ì‹¤ì œ ë³€í™˜ì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.
    
    ë§ˆì§€ë§‰ìœ¼ë¡œ **List<TravelRoomResDto> ë°˜í™˜.**

### Record

- bolierplate codeë¥¼ ì¤„ì´ëŠ” ê²ƒì„ ëª©í‘œë¡œ ë„ì…ëœ íŠ¹ë³„í•œ í˜•íƒœì˜ í´ë˜ìŠ¤ ì„ ì–¸ ë°©ë²•

### Record êµ¬ì¡°

```java
public record TestRecord(String name, int age) {}
```

- record ì„ ì–¸ë§Œìœ¼ë¡œ ì•„ë˜ ê¸°ëŠ¥ ì œê³µ
    - ìƒì† ë¶ˆê°€ëŠ¥ ì²˜ë¦¬ (final class)
    - í•„ë“œ private final ì²˜ë¦¬ ë° Setter ë¯¸êµ¬í˜„ì„ í†µí•œ ë¶ˆë³€ì„± ì œê³µ
    - Getter ìƒì„±
    - `equals()` : í•„ë“œ ê°’ì— ë”°ë¼ equals ë©”ì„œë“œê°€ ìë™ìœ¼ë¡œ ìƒì„±
    - `hashCode()` : í•„ë“œ ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ hashcode ë©”ì„œë“œ ìƒì„±
    - `toString()` : í•„ë“œ ê°’ì„ í¬í•¨í•œ ë¬¸ìì—´ í‘œí˜„ì„ ë°˜í™˜í•˜ëŠ” ë©”ì„œë“œ ìƒì„±

### Request / Response Dto

```java
public record RequestRecord(
        @NotNull @Size(min = 4) String name,
        @NotNull @Email String email
) {}
```

### ìƒì† ë¶ˆê°€

- recordëŠ” ì•”ë¬µì ìœ¼ë¡œ finalì´ê¸° ë•Œë¬¸ì—, ë‹¤ë¥¸ í´ë˜ìŠ¤ê°€ ì´ë¥¼ ìƒì†í•  ìˆ˜ ì—†ìŒ. ì´ëŠ” ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ê³ , ì˜ˆìƒì¹˜ ëª»í•œ ë™ì‘ì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ì„¤ê³„ì„.
- ëª¨ë“  í•„ë“œê°€ ë¶ˆë³€ì´ë‹¤. ê°€ë³€ì ì¸ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ê²½ìš° recordëŠ” ì í•©í•˜ì§€ ì•ŠìŒ

## ğŸ±ì˜¤ëŠ˜ì˜ íšŒê³ 
- springì´ ë§ì´ ë¶€ì¡±í•œê±¸ ëŠê¼‡ê³ , ì—˜ë¦¬í•œí…Œ ì •ë§ ë§ì´ ë°°ì› ë‹¤. ê¸°ë³¸ì ì¸ íë¦„ê³¼ ì‚¬ìš©ì´ìœ ë¥¼ ì´í•´í•œ ê²ƒ ê°™ë‹¤. ë‚´ì¼ì€ ì—¬í–‰ ì¼ì • api ë§ˆë¬´ë¦¬í•˜ê³ , db í™•ì¸í•˜ê³  ë§ˆë¬´ë¦¬ ì‘ì—… í•  ë“¯ í•˜ë‹¤.
> [!NOTE]

### Reference
- 


