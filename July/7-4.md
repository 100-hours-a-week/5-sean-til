# TIL Template

## ë‚ ì§œ: 2024-07-04

## Daily Scrum
- ìˆ˜ì—… ë‚´ìš© ì •ë¦¬
- mk ë°±ì—”ë“œ api

## Today Issue
### First Issue
- ëª¨ë‹¬ì—ì„œ ì‚¬ìš©ìž ìš”ì²­ì •ë³´ ì‚­ì œ api ë‚ ë¦¬ê³  ì‘ë‹µì„ ë°›ì„ ë•Œ ì˜¤ë¥˜ ë°œìƒ

1. ì‚¬ìš©ìžì—ê²ŒëŠ” ì—ëŸ¬ê°€ ë°œìƒ
2. ë°±ì—”ë“œ ì„œë²„ì—ì„œëŠ” ì œëŒ€ë¡œ 200, 204 state codeê°€ ë‚˜ì˜¤ê³  ìžˆë‹¤. 
3. ì‚¬ìš©ìžì—ê²Œ ì²˜ìŒì—ëŠ” ì˜¤ë¥˜ê°€ ëœ¨ê³ , ìƒˆë¡œê³ ì¹¨ ì‹œ ì‚­ì œê°€ ì ìš©ë¼ì„œ ìœ ì €ì—ê²Œ ë³´ì—¬ì§„ë‹¤.

```
  //ì‚­ì œë²„íŠ¼ í´ë¦­
  const handleDelete = async () => {
    const confirmDelete = window.confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?");
    if (!confirmDelete) return;
    console.log("requestData._id", requestData.word)
    try {
      const response = await api.delete(`/users/requests/${requestData.word}`);
      if (response.data && response.data.status === 'deleted successfully') {
        alert("ì‚­ì œëìŠµë‹ˆë‹¤");
        onClose();
        onDeleteSuccess(); // íŽ˜ì´ì§€ ìž¬ëžœë”ë§ì„ ìœ„í•´ ì½œë°± í˜¸ì¶œ
      } 
    } catch (error) {
      console.error("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
    }
  };
```

### How I solved
- ì•„ì§ í•´ê²° ëª»í•¨.

## Today I Learned

### ë°ì´í„° ì‚½ìž… (insert)

1. insert - ë‹¨ì¼ í˜¹ì€ ë‹¤ìˆ˜ì˜ ë„íë¨¼íŠ¸ë¥¼ ìž…ë ¥í•  ë•Œ ì‚¬ìš©.
2. insertOne - ë‹¨ì¼ Documentë¥¼ ìž…ë ¥í•  ë•Œ ì‚¬ìš©
3. insertMany - ë‹¤ìˆ˜ì˜ Documentë¥¼ ìž…ë ¥í•  ë•Œ ì‚¬ìš©

```jsx
db.book.insert({
    "name":"C", 
    "hits":30, 
    "auther":[
        {"name":"kim"},
        {"name":"choi"}
    ]
});
```

### ë°ì´í„° ì¡°íšŒ (find)

1. find - ë„íë¨¼íŠ¸ ë¦¬ìŠ¤íŠ¸ í™•ì¸
2. find().pretty() - ë„íë¨¼íŠ¸ ê¹”ë”í•˜ê²Œ ë³´ì—¬ì¤Œ

```jsx
// ë‹¤íë¨¼íŠ¸ë¥¼ ì¢€ë” ê¹”ë”í•˜ê²Œ ë³´ì—¬
db.book.find().pretty() 

// nameì´ Aì¸ documentì„ ì¡°íšŒ
db.book.find({"name":"A"}).pretty()

db.monsters.findOne({ name: 'Slime' });
// ë‹¨ í•˜ë‚˜ë§Œ ì°¾ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©. find(...)[0]ê³¼ë„ ê°™ë‹¤. 
// find ë©”ì†Œë“œë¡œ ì°¾ì€ ê²ƒ ì¤‘ì— ì²« ë²ˆì§¸ ê²ƒì„ ì„ íƒ
```

### ë…¼ë¦¬ì—°ì‚°ìž

```jsx
{ í•„ë“œ: { $gt: ê°’ } } // í•„ë“œ > ê°’
{ í•„ë“œ: { $lt: ê°’ } } // í•„ë“œ < ê°’
{ í•„ë“œ: { $gte: ê°’ } } // í•„ë“œ >= ê°’
{ í•„ë“œ: { $lte: ê°’ } } // í•„ë“œ <= ê°’

{ í•„ë“œ: { $eq: ê°’ } } // í•„ë“œ == ê°’
{ í•„ë“œ: { $ne: ê°’ } } // í•„ë“œ != ê°’

{ í•„ë“œ: { $in: [ ê°’1, ê°’2, ê°’3, ... ] } // í•„ë“œ == (ê°’1 or ê°’2 or ê°’3)
{ í•„ë“œ: { $nin: [ ê°’1, ê°’2, ê°’3, ... ] } // í•„ë“œ != (ê°’1 and ê°’2 and ê°’3)

// ì¡°ê±´1 or ì¡°ê±´2
{ $or: [ { ì¡°ê±´1 }, { ì¡°ê±´2 }, ... ] } 

// ì¡°ê±´ì´ ê°„ë‹¨í•˜ë©´ ê·¸ëƒ¥ { í•„ë“œ: ê°’, í•„ë“œ: ê°’ } ì´ë ‡ê²Œ $andê°€ ì—†ì–´ë„ ë˜ì§€ë§Œ, ì—¬ëŸ¬ ë…¼ë¦¬ì—°ì‚°ìžë¥¼ ê²¹ì³ ì“¸ ê²½ìš° $andê°€ í•„ìš”í•©ë‹ˆë‹¤.
// (ì¡°ê±´1 or ì¡°ê±´2) and (ì¡°ê±´3 or ì¡°ê±´4)
{ $and: [
  { $or: [{ ì¡°ê±´1 }, { ì¡°ê±´2 }] },
  { $or: [{ ì¡°ê±´3 }, { ì¡°ê±´4 }] }
] }

// ì¡°ê±´1, ì¡°ê±´2 ... ëª¨ë‘ ë§Œì¡±í•˜ì§€ ì•ŠëŠ” ë‹¤íë¨¼íŠ¸
{ $nor: [{ ì¡°ê±´1 }, { ì¡°ê±´2 }, ...] } 

// ì¡°ê±´ì´ ì•„ë‹Œê°’.  $norì˜ ë‹¨ì¼ ë²„ì „
{ $not: { ì¡°ê±´ } }
```

### ì¡°ê±´ $where

- ìžë°” ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²•ì„ ì‚¬ìš©í•´ ê²€ìƒ‰
- thisë¥¼ ì¨ì¤˜ì•¼ ì¸ì‹í•¨.

```jsx
db.book.find({
    $where: "this.name == 'A'"
})
// $whereì„ ì´ìš©í•˜ë©´ ìžë°”ìŠ¤í¬ë¦½íŠ¸ í‘œí˜„ì‹(expression)ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.

// ë‹¤ìŒ ì¿¼ë¦¬ë¥¼ $whereë¡œ ê°„ë‹¨í•˜ê²Œ í‘œí˜„ ê°€ëŠ¥í•˜ë‹¤.
db.book.find({ $or: [ {name: 'A'}, {hits: {$lte: 50}} ] })
// ==
db.book.find({ $where: "this.name == 'A' || this.hits <= 50" })

//ì •ë ¬
db.book.find()
	.sort({"hits":1})
    .pretty()

```

### ë°ì´í„° ìˆ˜ì •

- ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ì¿¼ë¦¬ë§Œ ìˆ˜ì •
- $setì„ í•´ì•¼ í•´ë‹¹ í•„ë“œë§Œ ë°”ë€ë‹¤. ( $setì„ ì•ˆë„£ê³  í•˜ë©´ ì•ˆëœë‹¤.)

```jsx
db.book.update({
    "hits":110
}, {
    $set:{
    	"hits":120
    }
})
// hits:110ì¸ê±¸ ê²€ìƒ‰í•´ì„œ 120ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•˜ë¼
// update ì²«ë²ˆì§¸ì¸ìžëŠ” ê²€ìƒ‰ ì¿¼ë¦¬ key/field, ë‘ë²ˆì§¸ ì¸ìžëŠ” ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ {$set: {key:field}}

db.book.update({
    "hits":120 // hitsì´ 120ì¸ê±¸ ì°¾ì•„
}, {
	$set: {
    	hits:125, // 125ë¡œ ì—…ë°ì´íŠ¸ë¥¼ í•˜ë©°,
    	name:"AA" // ê¸°ì¡´ì— nameì´ ì—†ì—ˆëŠ”ë° AAë¥¼ ì¶”ê°€
    }
})

```

### FindAndModify

- upsert(update + insert) ê³¼ remove ê¹Œì§€ ê°™ì´ ìˆ˜í–‰.
- í•œ í–‰ë§Œ ì—…ë°ì´íŠ¸
- query - ëŒ€ìƒì„ ì°¾ëŠ” ë²•.
- update - ëŒ€ìƒì„ ìˆ˜ì •í•  ë‚´ìš©
- new - ìˆ˜ì • ì´ì „ì˜ ë‹¤íë¨¼íŠ¸ë¥¼ ë°˜í™˜í• ì§€, ìˆ˜ì • ì´í›„ì˜ ë‹¤íë¨¼íŠ¸ë¥¼ ë°˜í™˜í• ì§€ ê²°ì •í•˜ëŠ” ë¶€ë¶„ {new : true} ì´ë©´ ìˆ˜ì • ì´í›„ ë‹¤íë¨¼íŠ¸ë¥¼ ë°˜í™˜
- ìˆ˜ì •í•œ í›„ ìˆ˜ì •ëœ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ê³  ì‹¶ë‹¤ë©´ update ëŒ€ì‹  findAndModifyë¥¼ ì“°ëŠ”ê²Œ ì¢‹ë‹¤.

```jsx
db.monsters.findAndModify({ 
    query: { name: 'Demon' }, 
    update: { $set: { att: 150 } }, 
    new: true 
});
/*
1. query - name: 'Demon'ì¸ ê²ƒì„
2. update - att: 150 ë¡œ ë‚´ìš©ì„ ìˆ˜ì •
3. new : true - ìˆ˜ì • ì´í›„ì˜ ë‹¤íë¨¼íŠ¸ë¥¼ ë°˜í™˜
*/
```
## ðŸŽ±ì˜¤ëŠ˜ì˜ íšŒê³ 
- ì˜¤ë¥˜ë¥¼ ì°¾ì•„ê°€ëŠ” ê³¼ì •ì´ ì •ë§ ê³ ë˜ë‹¤. ì˜¤ëŠ˜ì€ ë­”ê°€ ìž˜ ì•ˆë˜ëŠ”ë‚ ..

### Reference
- https://inpa.tistory.com/entry/MONGO-ðŸ“š-ëª½ê³ ë””ë¹„-ì¿¼ë¦¬-ì •ë¦¬

> [!NOTE]

